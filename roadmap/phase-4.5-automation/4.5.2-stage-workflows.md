# Feature 4.5.2: Stage-Aware Workflows

## Metadata
| Field | Value |
|-------|-------|
| **Feature ID** | 4.5.2 |
| **Phase** | 4.5 - Automation & Workflows |
| **Priority** | Critical |
| **Estimated Effort** | 6-8 hours |
| **Dependencies** | 4.5.1 (Workflow Engine), 2.4 (Business Entity) |
| **Approval** | [ ] |
| **Status** | Not Started |

---

## Overview

Pre-built, expert-designed workflows for each business stage that auto-trigger based on stage progression and guide founders through proven processes.

## Requirements

### Functional
1. Stage-specific workflow library
2. Auto-trigger on stage entry
3. Quality gate enforcement
4. Workflow recommendations
5. Progress visibility

### Non-Functional
- Workflows based on YC/startup best practices
- Adaptable to business context
- Non-blocking (can skip)

---

## Workflow Library

### IDEA Stage (4 workflows)

**1. Problem Validation Workflow**
```yaml
Steps:
1. Define problem (1-2 sentences)
2. Identify 5 specific people with this problem
3. Research: How do they solve it today?
4. Conduct 3-5 customer interviews
5. Decision: Is this a real problem worth solving?

Quality Gate: 3+ validated interviews
```

**2. Target Customer Definition**
```yaml
Steps:
1. Demographics (age, income, location, role)
2. Psychographics (goals, fears, frustrations)
3. Current behavior (what they do now)
4. Research: Market size estimation
5. Create customer persona document

Quality Gate: Specific persona created
```

**3. Competition Analysis**
```yaml
Steps:
1. List 5 direct competitors
2. List 5 indirect/alternative solutions
3. Research: Competitive positioning
4. Identify gaps in market
5. Define unique angle

Quality Gate: Differentiation identified
```

**4. Solution Hypothesis**
```yaml
Steps:
1. Draft solution (features, not implementation)
2. Validate: Would customers pay?
3. Research: Pricing benchmarks
4. Define MVP scope (max 3 features)
5. Decision: Build or pivot?

Quality Gate: MVP scoped, willingness to pay validated
```

---

### MVP Stage (4 workflows)

**1. MVP Scoping & Build**
```yaml
Steps:
1. Define core feature set (max 3 features)
2. Sketch mockups/wireframes
3. Estimate: Time to build
4. Build checklist (break into tasks)
5. Weekly progress check-in (auto-scheduled)
6. Decision: Ship or iterate?

Quality Gate: MVP launched
```

**2. First Customer Acquisition**
```yaml
Steps:
1. Identify 10 potential first customers
2. Outreach plan (email, calls, network)
3. Conduct demos/trials
4. Collect feedback (structured)
5. Decision: Did someone pay?

Quality Gate: 1+ paying customer
```

**3. Product-Market Fit Testing**
```yaml
Steps:
1. Define success metric (retention, NPS, etc.)
2. Track usage for 2 weeks
3. Collect qualitative feedback
4. Research: Churn analysis
5. Decision: Do users love it?

Quality Gate: Evidence of PMF
```

**4. Unit Economics Validation**
```yaml
Steps:
1. Calculate CAC (Customer Acquisition Cost)
2. Calculate LTV (Lifetime Value)
3. Measure retention rate
4. Decision: Are economics viable?

Quality Gate: LTV > 3x CAC
```

---

### GROWTH Stage (4 workflows)

**1. Scaling Playbook**
```yaml
Steps:
1. Identify working channel (organic, paid, sales)
2. Double down: 2x investment in working channel
3. Measure: CAC, conversion, retention
4. Hire: First growth role
5. Weekly metrics review

Quality Gate: Consistent month-over-month growth
```

**2. Team Building**
```yaml
Steps:
1. Identify critical hire (eng, sales, marketing)
2. Write job description
3. Source candidates (network, recruiter)
4. Interview & hire
5. Onboarding checklist

Quality Gate: Key role filled
```

**3. Process Documentation**
```yaml
Steps:
1. Document sales process
2. Document onboarding process
3. Document support process
4. Train team on processes
5. Measure adherence

Quality Gate: Processes documented & followed
```

**4. Fundraising Preparation**
```yaml
Steps:
1. Build pitch deck
2. Create financial model
3. Research: Investor fit
4. Warm intro to 10 investors
5. Conduct meetings
6. Decision: Term sheet received?

Quality Gate: Funding secured or decision to bootstrap
```

---

### SCALE Stage (3 workflows)

**1. Delegation Framework**
```yaml
Steps:
1. List all founder tasks
2. Categorize: Delegate, automate, eliminate
3. Hire: C-level roles
4. Build reporting structure
5. Weekly exec team meetings

Quality Gate: Founder not in day-to-day
```

**2. System Optimization**
```yaml
Steps:
1. Identify bottlenecks (sales, ops, product)
2. Implement tools/automation
3. Measure: Efficiency gains
4. Document playbooks
5. Scale successful systems

Quality Gate: 2x efficiency improvement
```

**3. Market Expansion**
```yaml
Steps:
1. Identify adjacent market
2. Research: Market sizing
3. Pilot: Launch in new segment
4. Measure: Success metrics
5. Decision: Expand or focus?

Quality Gate: New market validated
```

---

## Technical Implementation

```typescript
// src/core/workflows/stage-workflows.ts
export const STAGE_WORKFLOWS: Record<BusinessStage, WorkflowDefinition[]> = {
  idea: [
    PROBLEM_VALIDATION_WORKFLOW,
    TARGET_CUSTOMER_WORKFLOW,
    COMPETITION_ANALYSIS_WORKFLOW,
    SOLUTION_HYPOTHESIS_WORKFLOW,
  ],
  mvp: [
    MVP_SCOPING_WORKFLOW,
    FIRST_CUSTOMER_WORKFLOW,
    PMF_TESTING_WORKFLOW,
    UNIT_ECONOMICS_WORKFLOW,
  ],
  growth: [
    SCALING_PLAYBOOK_WORKFLOW,
    TEAM_BUILDING_WORKFLOW,
    PROCESS_DOCUMENTATION_WORKFLOW,
    FUNDRAISING_WORKFLOW,
  ],
  scale: [
    DELEGATION_FRAMEWORK_WORKFLOW,
    SYSTEM_OPTIMIZATION_WORKFLOW,
    MARKET_EXPANSION_WORKFLOW,
  ],
};

export class StageWorkflowManager {
  constructor(
    private workflowEngine: WorkflowEngine,
    private businessService: BusinessService
  ) {}

  async onStageChange(businessId: string, newStage: BusinessStage): Promise<void> {
    // Auto-start recommended workflows for new stage
    const workflows = STAGE_WORKFLOWS[newStage];

    for (const workflow of workflows) {
      if (workflow.trigger.auto_start) {
        await this.workflowEngine.startWorkflow(workflow.id, businessId);
      }
    }
  }

  async getRecommendedWorkflows(businessId: string): Promise<WorkflowDefinition[]> {
    const business = await this.businessService.getActive();
    return STAGE_WORKFLOWS[business.stage];
  }

  async getActiveWorkflows(businessId: string): Promise<WorkflowExecution[]> {
    return this.workflowEngine.getActiveWorkflows(businessId);
  }
}
```

---

## Tasks

| Task | Estimate |
|------|----------|
| Design IDEA stage workflows | 90 min |
| Design MVP stage workflows | 90 min |
| Design GROWTH stage workflows | 60 min |
| Design SCALE stage workflows | 45 min |
| Create workflow YAML files | 60 min |
| Implement StageWorkflowManager | 45 min |
| Add auto-trigger logic | 30 min |
| Write tests | 30 min |

---

## Acceptance Criteria
- [ ] 15 pre-built workflows
- [ ] Auto-trigger on stage change
- [ ] Quality gates defined
- [ ] Workflows adaptable to context
- [ ] Progress visible to user
- [ ] Can skip non-critical workflows

