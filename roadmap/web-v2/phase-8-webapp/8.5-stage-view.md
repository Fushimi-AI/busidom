# Feature 8.5: Business Stage View (Web)

## Metadata
| Field | Value |
|-------|-------|
| **Feature ID** | WEB-8.5 |
| **Phase** | 8 - Web Application (Web) |
| **Priority** | Medium |
| **Estimated Effort** | 3-4 hours |
| **Dependencies** | WEB-8.1 (Next.js Setup), WEB-2.4 (Business Entity) |
| **Approval** | [ ] |
| **Status** | Not Started |

---

## Overview

Visual business overview showing current stage, progress indicators, key metrics, recommended next steps, and stage progression roadmap.

## User Story

As a **web user**, I want **a clear view of my business stage and progress** so that **I know exactly what to focus on next**.

---

## Requirements

### Functional
1. Display current business stage
2. Show stage-specific metrics
3. Recommend next steps
4. Display stage progression roadmap
5. Show completed workflows
6. Track key milestones
7. Edit business details

### Non-Functional
- Visual progress indicators
- Clear actionable recommendations
- Mobile-responsive
- Fast loading

---

## Technical Specification

### Business Dashboard Page

```tsx
// src/app/(dashboard)/businesses/[id]/page.tsx
'use client';

import { useEffect, useState } from 'react';
import { useParams } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { StageProgressBar } from '@/components/business/stage-progress-bar';
import { StageMetrics } from '@/components/business/stage-metrics';
import { NextSteps } from '@/components/business/next-steps';
import { BusinessHeader } from '@/components/business/business-header';
import { Business } from '@/types';

export default function BusinessPage() {
  const params = useParams();
  const [business, setBusiness] = useState<Business | null>(null);

  useEffect(() => {
    fetchBusiness();
  }, [params.id]);

  const fetchBusiness = async () => {
    const res = await fetch(`/api/businesses/${params.id}`);
    const data = await res.json();
    setBusiness(data);
  };

  if (!business) {
    return <div>Loading...</div>;
  }

  return (
    <div className="space-y-6">
      <BusinessHeader business={business} onUpdate={fetchBusiness} />

      <StageProgressBar currentStage={business.stage} />

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <StageMetrics business={business} />
        <NextSteps business={business} />
      </div>
    </div>
  );
}
```

### Stage Progress Bar

```tsx
// src/components/business/stage-progress-bar.tsx
'use client';

import { BusinessStage } from '@/types';
import { CheckCircle, Circle } from 'lucide-react';
import { cn } from '@/lib/utils';

interface StageProgressBarProps {
  currentStage: BusinessStage;
}

const STAGES: { id: BusinessStage; name: string }[] = [
  { id: 'idea', name: 'Idea' },
  { id: 'validation', name: 'Validation' },
  { id: 'mvp', name: 'MVP' },
  { id: 'growth', name: 'Growth' },
  { id: 'scale', name: 'Scale' }
];

export function StageProgressBar({ currentStage }: StageProgressBarProps) {
  const currentIndex = STAGES.findIndex(s => s.id === currentStage);

  return (
    <Card>
      <CardHeader>
        <h3 className="font-semibold">Business Stage</h3>
      </CardHeader>

      <CardContent>
        <div className="flex items-center justify-between">
          {STAGES.map((stage, index) => {
            const isComplete = index < currentIndex;
            const isCurrent = index === currentIndex;

            return (
              <div key={stage.id} className="flex items-center">
                <div className="flex flex-col items-center">
                  <div
                    className={cn(
                      'w-10 h-10 rounded-full flex items-center justify-center border-2',
                      isComplete && 'bg-green-600 border-green-600 text-white',
                      isCurrent && 'bg-blue-600 border-blue-600 text-white',
                      !isComplete && !isCurrent && 'border-gray-300'
                    )}
                  >
                    {isComplete ? (
                      <CheckCircle className="w-5 h-5" />
                    ) : (
                      <Circle className="w-5 h-5" />
                    )}
                  </div>

                  <p
                    className={cn(
                      'text-sm mt-2',
                      isCurrent && 'font-semibold'
                    )}
                  >
                    {stage.name}
                  </p>
                </div>

                {index < STAGES.length - 1 && (
                  <div
                    className={cn(
                      'h-0.5 w-12 mx-2',
                      isComplete ? 'bg-green-600' : 'bg-gray-300'
                    )}
                  />
                )}
              </div>
            );
          })}
        </div>
      </CardContent>
    </Card>
  );
}
```

### Stage Metrics

```tsx
// src/components/business/stage-metrics.tsx
'use client';

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Business } from '@/types';
import { Target, Users, TrendingUp, CheckSquare } from 'lucide-react';

interface StageMetricsProps {
  business: Business;
}

const STAGE_METRICS = {
  idea: [
    { label: 'Problem Validated', icon: Target, key: 'problemStatement' },
    { label: 'Target Customer Defined', icon: Users, key: 'targetCustomer' }
  ],
  validation: [
    { label: 'Customer Interviews', icon: Users, key: 'interviews' },
    { label: 'Problem-Solution Fit', icon: CheckSquare, key: 'problemSolutionFit' }
  ],
  mvp: [
    { label: 'MVP Built', icon: CheckSquare, key: 'mvpBuilt' },
    { label: 'Beta Users', icon: Users, key: 'betaUsers' }
  ],
  growth: [
    { label: 'Revenue', icon: TrendingUp, key: 'revenue' },
    { label: 'Active Users', icon: Users, key: 'activeUsers' }
  ],
  scale: [
    { label: 'Team Size', icon: Users, key: 'teamSize' },
    { label: 'MRR', icon: TrendingUp, key: 'mrr' }
  ]
};

export function StageMetrics({ business }: StageMetricsProps) {
  const metrics = STAGE_METRICS[business.stage] || [];

  return (
    <Card>
      <CardHeader>
        <CardTitle>Key Metrics</CardTitle>
      </CardHeader>

      <CardContent className="space-y-4">
        {metrics.map((metric) => {
          const Icon = metric.icon;
          const value = business.context[metric.key] || 'Not set';

          return (
            <div key={metric.key} className="flex items-center gap-3">
              <div className="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center">
                <Icon className="w-5 h-5 text-primary" />
              </div>

              <div>
                <p className="text-sm text-muted-foreground">{metric.label}</p>
                <p className="font-medium">{value}</p>
              </div>
            </div>
          );
        })}
      </CardContent>
    </Card>
  );
}
```

### Next Steps Recommendations

```tsx
// src/components/business/next-steps.tsx
'use client';

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Business } from '@/types';
import { ArrowRight, CheckCircle } from 'lucide-react';

interface NextStepsProps {
  business: Business;
}

const NEXT_STEPS = {
  idea: [
    {
      title: 'Define Your Target Customer',
      description: 'Identify who will benefit most from your solution',
      action: 'Start Workflow',
      workflowId: 'target_customer'
    },
    {
      title: 'Validate the Problem',
      description: 'Ensure the problem is worth solving',
      action: 'Start Workflow',
      workflowId: 'problem_validation'
    }
  ],
  validation: [
    {
      title: 'Conduct Customer Interviews',
      description: 'Interview 10+ potential customers',
      action: 'Start Workflow',
      workflowId: 'customer_validation'
    },
    {
      title: 'Build MVP Prototype',
      description: 'Create a minimal version to test',
      action: 'Start Workflow',
      workflowId: 'mvp_planning'
    }
  ],
  mvp: [
    {
      title: 'Launch to Beta Users',
      description: 'Get your MVP in front of real users',
      action: 'Start Workflow',
      workflowId: 'beta_launch'
    },
    {
      title: 'Collect User Feedback',
      description: 'Gather insights to improve product',
      action: 'Start Workflow',
      workflowId: 'feedback_collection'
    }
  ],
  growth: [
    {
      title: 'Optimize Conversion Funnel',
      description: 'Increase signup to paid conversion',
      action: 'Start Workflow',
      workflowId: 'funnel_optimization'
    },
    {
      title: 'Scale Marketing Channels',
      description: 'Find scalable acquisition channels',
      action: 'Start Workflow',
      workflowId: 'marketing_scale'
    }
  ],
  scale: [
    {
      title: 'Build Leadership Team',
      description: 'Hire experienced executives',
      action: 'Start Workflow',
      workflowId: 'team_building'
    },
    {
      title: 'Expand to New Markets',
      description: 'Identify expansion opportunities',
      action: 'Start Workflow',
      workflowId: 'market_expansion'
    }
  ]
};

export function NextSteps({ business }: NextStepsProps) {
  const steps = NEXT_STEPS[business.stage] || [];

  return (
    <Card>
      <CardHeader>
        <CardTitle>Recommended Next Steps</CardTitle>
      </CardHeader>

      <CardContent className="space-y-4">
        {steps.map((step, index) => (
          <div key={index} className="border rounded-lg p-4">
            <div className="flex items-start justify-between mb-2">
              <h4 className="font-medium">{step.title}</h4>
            </div>

            <p className="text-sm text-muted-foreground mb-3">
              {step.description}
            </p>

            <Button
              variant="outline"
              size="sm"
              onClick={() => window.location.href = `/workflows/${step.workflowId}/start`}
            >
              {step.action}
              <ArrowRight className="w-4 h-4 ml-2" />
            </Button>
          </div>
        ))}
      </CardContent>
    </Card>
  );
}
```

---

## Tasks

| Task | Estimate |
|------|----------|
| Create business dashboard page | 30 min |
| Build stage progress bar | 45 min |
| Build stage metrics component | 45 min |
| Build next steps component | 45 min |
| Add business header | 30 min |
| Write tests | 30 min |

---

## Acceptance Criteria
- [ ] Stage progress bar shows current stage
- [ ] Stage-specific metrics displayed
- [ ] Next steps recommendations shown
- [ ] Can edit business details
- [ ] Mobile-responsive
- [ ] Visual and intuitive

---

## Dependencies

Already included in WEB-8.1
