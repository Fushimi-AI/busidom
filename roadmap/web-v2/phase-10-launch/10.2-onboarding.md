# Feature 10.2: User Onboarding Flow (Web)

## Metadata
| Field | Value |
|-------|-------|
| **Feature ID** | WEB-10.2 |
| **Phase** | 10 - Launch & Growth (Web) |
| **Priority** | High |
| **Estimated Effort** | 3-4 hours |
| **Dependencies** | WEB-8.1 (Next.js Setup), WEB-7.2 (Auth System) |
| **Approval** | [ ] |
| **Status** | Not Started |

---

## Overview

Interactive onboarding flow for new users: create business, set goals, configure API keys, and complete first conversation.

---

## Technical Specification

### Onboarding Flow

```tsx
// src/app/onboarding/page.tsx
'use client';

import { useState } from 'react';
import { CreateBusinessStep } from '@/components/onboarding/CreateBusinessStep';
import { APIKeysStep } from '@/components/onboarding/APIKeysStep';
import { FirstChatStep } from '@/components/onboarding/FirstChatStep';
import { Progress } from '@/components/ui/progress';

const STEPS = [
  { id: 1, name: 'Create Your Business', component: CreateBusinessStep },
  { id: 2, name: 'Set Up API Keys', component: APIKeysStep },
  { id: 3, name: 'Start Your First Chat', component: FirstChatStep }
];

export default function OnboardingPage() {
  const [currentStep, setCurrentStep] = useState(1);
  const [data, setData] = useState({});

  const progress = (currentStep / STEPS.length) * 100;
  const CurrentStepComponent = STEPS[currentStep - 1].component;

  const handleNext = (stepData: any) => {
    setData({ ...data, ...stepData });

    if (currentStep < STEPS.length) {
      setCurrentStep(currentStep + 1);
    } else {
      // Complete onboarding
      completeOnboarding();
    }
  };

  const completeOnboarding = async () => {
    await fetch('/api/user/complete-onboarding', {
      method: 'POST'
    });

    window.location.href = '/dashboard';
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-background p-6">
      <div className="max-w-2xl w-full">
        <div className="mb-8">
          <h1 className="text-3xl font-bold mb-2">Welcome to Business-OS</h1>
          <p className="text-muted-foreground">
            Let's set up your account in 3 quick steps
          </p>
        </div>

        <Progress value={progress} className="mb-8" />

        <div className="bg-card rounded-lg border p-8">
          <CurrentStepComponent onNext={handleNext} data={data} />
        </div>

        <div className="mt-4 flex justify-center gap-2">
          {STEPS.map((step) => (
            <div
              key={step.id}
              className={`w-3 h-3 rounded-full ${
                step.id === currentStep
                  ? 'bg-primary'
                  : step.id < currentStep
                  ? 'bg-green-600'
                  : 'bg-gray-300'
              }`}
            />
          ))}
        </div>
      </div>
    </div>
  );
}
```

### Step 1: Create Business

```tsx
// src/components/onboarding/CreateBusinessStep.tsx
'use client';

import { useState } from 'react';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Button } from '@/components/ui/button';
import { Select } from '@/components/ui/select';

interface Props {
  onNext: (data: any) => void;
  data: any;
}

export function CreateBusinessStep({ onNext, data }: Props) {
  const [name, setName] = useState(data.businessName || '');
  const [industry, setIndustry] = useState(data.industry || '');
  const [stage, setStage] = useState(data.stage || 'idea');

  const handleSubmit = async () => {
    const res = await fetch('/api/businesses', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, industry, stage })
    });

    const business = await res.json();

    onNext({ businessId: business.id, businessName: name, industry, stage });
  };

  return (
    <div className="space-y-6">
      <div>
        <h2 className="text-2xl font-bold mb-2">Create Your First Business</h2>
        <p className="text-muted-foreground">
          Tell us about what you're building
        </p>
      </div>

      <div className="space-y-4">
        <div>
          <Label>Business Name *</Label>
          <Input
            value={name}
            onChange={(e) => setName(e.target.value)}
            placeholder="e.g., Acme SaaS"
          />
        </div>

        <div>
          <Label>Industry</Label>
          <Input
            value={industry}
            onChange={(e) => setIndustry(e.target.value)}
            placeholder="e.g., B2B SaaS, E-commerce, AI"
          />
        </div>

        <div>
          <Label>Current Stage *</Label>
          <Select value={stage} onValueChange={setStage}>
            <option value="idea">Idea</option>
            <option value="validation">Validation</option>
            <option value="mvp">MVP</option>
            <option value="growth">Growth</option>
            <option value="scale">Scale</option>
          </Select>
        </div>
      </div>

      <Button
        className="w-full"
        onClick={handleSubmit}
        disabled={!name || !stage}
      >
        Continue
      </Button>
    </div>
  );
}
```

### Step 2: API Keys

```tsx
// src/components/onboarding/APIKeysStep.tsx
export function APIKeysStep({ onNext }: Props) {
  const [apiKey, setApiKey] = useState('');
  const [provider, setProvider] = useState('openai');

  const handleSubmit = async () => {
    await fetch('/api/user/api-keys', {
      method: 'PATCH',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ provider, key: apiKey })
    });

    onNext({ apiKeyConfigured: true });
  };

  return (
    <div className="space-y-6">
      <div>
        <h2 className="text-2xl font-bold mb-2">Configure Your AI</h2>
        <p className="text-muted-foreground">
          Add your OpenAI API key to enable AI features
        </p>
      </div>

      <div className="space-y-4">
        <div>
          <Label>Provider</Label>
          <Select value={provider} onValueChange={setProvider}>
            <option value="openai">OpenAI (Recommended)</option>
            <option value="anthropic">Anthropic</option>
            <option value="kimi">Kimi</option>
          </Select>
        </div>

        <div>
          <Label>API Key *</Label>
          <Input
            type="password"
            value={apiKey}
            onChange={(e) => setApiKey(e.target.value)}
            placeholder="sk-..."
          />
          <p className="text-sm text-muted-foreground mt-1">
            Get your key from{' '}
            <a href="https://platform.openai.com/api-keys" target="_blank" className="underline">
              OpenAI Platform
            </a>
          </p>
        </div>
      </div>

      <div className="flex gap-2">
        <Button variant="outline" className="flex-1" onClick={() => onNext({ skip: true })}>
          Skip for Now
        </Button>
        <Button className="flex-1" onClick={handleSubmit} disabled={!apiKey}>
          Continue
        </Button>
      </div>
    </div>
  );
}
```

---

## Tasks

| Task | Estimate |
|------|----------|
| Create onboarding page | 45 min |
| Build step components | 60 min |
| Add progress tracking | 20 min |
| Implement completion logic | 30 min |
| Add skip functionality | 20 min |
| Write tests | 30 min |

---

## Acceptance Criteria
- [ ] 3-step onboarding flow
- [ ] Business creation works
- [ ] API key setup works
- [ ] Can skip optional steps
- [ ] Progress tracked
- [ ] Completion redirects to dashboard
- [ ] Mobile-responsive

---

## Dependencies

Already included in WEB-8.1
